sources:
  - name: sales
    database: raw_database
    config:
      freshness: # default freshness
        # changed to config in v1.9
        warn_after: {count: 12, period: hour}
        error_after: {count: 24, period: hour}
      loaded_at_field: updated_at
    tables:
      - name: ticket_sales_online
        columns:
          - name: sale_id
            tests:
              - unique
              - not_null
          - name: customer_id
            tests:
              - not_null
          - name: ticket_id
            tests:
              - not_null
          - name: purchase_date
            tests:
              - not_null
          - name: visit_date
            tests:
              - not_null
          - name: purchase_timestamp
            tests:
              - not_null
          - name: ticket_price
            tests:
              - not_null
              - dbt_utils.accepted_range:
                  arguments:
                    min_value: 0
          - name: discount_percent
            tests:
              - dbt_utils.accepted_range:
                  arguments:
                    min_value: 0
                    max_value: 100
          - name: visit_hour
            tests:
              - dbt_utils.accepted_range:
                  arguments:
                    min_value: 0
                    max_value: 23
          - name: payment_method
            tests:
              - not_null
          - name: purchase_channel
            tests:
              - not_null
          - name: created_at
            tests:
              - not_null
          - name: updated_at
            tests:
              - not_null

      - name: ticket_sales_physical
        columns:
          - name: sale_id
            tests:
              - unique
              - not_null
          - name: customer_id
            tests:
              - not_null
          - name: ticket_id
            tests:
              - not_null
          - name: purchase_date
            tests:
              - not_null
          - name: visit_date
            tests:
              - not_null
          - name: purchase_timestamp
            tests:
              - not_null
          - name: ticket_price
            tests:
              - not_null
              - dbt_utils.accepted_range:
                  arguments:
                    min_value: 0
          - name: discount_percent
            tests:
              - dbt_utils.accepted_range:
                  arguments:
                    min_value: 0
                    max_value: 100
          - name: visit_hour
            tests:
              - dbt_utils.accepted_range:
                  arguments:
                    min_value: 0
                    max_value: 23
          - name: payment_method
            tests:
              - not_null
          - name: purchase_channel
            tests:
              - not_null
          - name: created_at
            tests:
              - not_null
          - name: updated_at
            tests:
              - not_null

      - name: merchandise_sales_online
        columns:
          - name: category
          - name: created_at
          - name: customer_id
          - name: discount_applied
          - name: haunted_house_id
          - name: payment_method
          - name: product_id
          - name: product_name
          - name: quantity
          - name: sale_date
          - name: sale_id
          - name: sale_timestamp
          - name: staff_member
          - name: total_price
          - name: unit_price

      - name: merchandise_sales_physical
        columns:
          - name: category
          - name: created_at
          - name: customer_id
          - name: discount_applied
          - name: haunted_house_id
          - name: payment_method
          - name: product_id
          - name: product_name
          - name: quantity
          - name: sale_date
          - name: sale_id
          - name: sale_timestamp
          - name: staff_member
          - name: total_price
          - name: unit_price